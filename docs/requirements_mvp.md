# MVP 需求分析 (Requirement Analysis)

## 1. 项目愿景 (Project Vision)
> 一句话描述这个项目是什么，解决什么问题。
这个项目是我个人使用，需要AI在我比较繁忙时也能主动为我提供极致的陪伴感。即随时随地聊天、主动发信息问候、上下文与记忆高个性化，同时又需要兼顾一些token成本

## 2. 核心功能 (Core Features)
> 请列出第一版 (MVP) 必须包含的功能。
- **功能点 1**: AI拥有长期记忆，能维持一致性的人设。
- **功能点 2**: AI具有主动性，能根据之前的对话，当天的时间和日期，主动找话题或者发信息关心我.比如饭点、睡觉点问候，根据学习计划询问进度，在节日或生日等特殊日期进行祝福
- **功能点 3**: 我可以快捷的与系统进行交互，提供我状态相关的数据。类似于我早上起来能立马按个起床状态，洗澡前立马按个洗澡。然后我快捷记录的状态就能入数据库，在之后的对话中成为上下文参考。日后也能单独拿出来用于分析与可视化。（可视化：比如说根据我早上八点起床、上午学习算法、下午写项目，自动渲染出当天的时间轴；分析：比如说可以统计出我一个月的作息规律与学习时长）
在和AI对话时，也希望AI自主捕捉到我生活的信息，自主写入数据库。和我自己快捷记录效果相同
- **功能点 4**:多智能体群聊与私聊：能创建多个不同的AI智能体进行对话，他们可以设置不同的API、遵循不同的人设指令，每个智能体有自己的记忆库，但都能共享用户的信息。每个AI拥有群聊的上下文和自己与用户私聊的上下文，但无法看见其他AI与用户私聊的上下文。用户可以选择不同的AI智能体建立群聊
- **功能点 5**:日记本：AI可以在聊天时自主将重要内容/高情感浓度内容写入日记；也可每日定时生成当日的聊天总结日记
- **功能点 6**:token控制与日志：系统需要记录调用api时的请求与响应，方便排查bug与记录费用。
调用时可采取尽可能命中cache、RAG检索、多Agent协作等方式控制成本。
- **功能点 7**：对话记录持久化，写入数据库，支持导入导出

## 3. 用户体验 (User Experience)
> 你希望用户（你自己）如何与它交互？
- 界面风格：简约。我比较想要直接类似于电脑命令行的像素风。但其实无所谓，我只想实现前面的功能，前端对我来说不太重要，简单能看清就行。不想要太复杂的菜单，像命令行那样打命令跳转，quit就回上一级就挺好。
- 交互方式：希望能在手机上打开使用、收到AI消息等，比较便携。但项目跑到服务器上什么的也无所谓。只要用的时候能在手机上用就行。

## 4. 技术偏好/限制 (Technical Constraints)
> 如果你有特别想用的技术或必须要遵守的限制。
技术无所谓，最好比较主流+前沿的，文档支持多一些，能实现功能就行。
最主流的api得兼容
优先适配苹果16pro手机，因为是我的手机

AI人设、用户信息、上下文管理这几点很重要，AI必须要记得自己的基础人设、用户的基础信息、用户存数据库的生活信息和近期的上下文，不想出现上下文断裂和人设偏移。



## 5. 待调研/不确定项 (Open Questions)
> 你不确定是否需要，或者不确定如何实现的部分。
这些现在不急，我就随手记录一下想法。这一版都不用做
- 多模态：识图、语音识别、朗读、画图
- 杂七杂八的MCP：帮忙写计划、关联ide写代码什么的


## 6.追加需求与问题 2026-01-18
1. 部署相关问题：
    - 部署时的apikey安全吗
    - 部署后数据库依然能连上并进行读写吗
    - 部署时的主动消息相关功能能否正常使用，能否发提醒到我手机主界面
2. Agent个性化配置相关问题：
    - 请你给出我在当前系统中，修改Agent人设、记忆库、api url、api key的操作指南
    - 给出修改Agent主动发信息相关参数的操作指南
    - 给出修改Agent群聊行为（发信息概率等）的操作指南。解释目前Agent群聊行为的实现方式
3. 聊天历史加载：
    - 需要在新进入系统时，通过命令加载聊天记录
    - 聊天记录需要显示时间、具体与哪个Agent
    - 聊天记录需要支持导入导出
        在这里提供一个我设想的流程：用户进入->输入命令->命令可以是记录命令/查找命令/设置类命令，此时和AI聊天的无关；
        进入聊天的命令：
        新建聊天：@Agent名称 进入一个新的聊天，如果@多个Agent，就创建群聊。在这个聊天完成后，这个聊天也会变成一个历史聊天。可以被list查询
        进入历史聊天:用户输入命令，进入某个历史的聊天。再输入加载历史记录的命令，就出现这个聊天之前的历史记录。用户可以接着聊天
        聊天时也可以使用各种记录查找类命令
        quit:退出当前聊天，返回到命令行界面，即回到最开始
4. 前端样式相关：
    - 再简洁一些，纯黑白就行，不用加各种框和背景。emoji去掉
    - 聊天时的显示：类似终端 每条聊天最左上显示Agent名称和当前时间戳，或显示user用户名，下面展示聊天内容。
5. MCP相关：调研一下有什么在手机上比较方便的MCP，发邮件/写备忘录/写入手机的笔记App的。然后做的通用一点，就是我在对话里让AI给我邮箱里发一份内容，他们就能按我要求写的内容写好然后发给我。
6. 数据/上下文相关：
 目前有好几种不同的但是感觉我们好像混淆了，我在这里稍微总结一下
 - 对话历史：messages数组，哪个Agent说了什么，user说了什么
 - 请求与响应：原始的。我们给api接口里发了什么
 - Agent的人设信息
 - 用户的基本信息
 - 用户的生活状态类信息（用户记进去的）
 - 记忆库（AI记的）：AI主动记录的互动陪伴性质的
 - 导入式记忆库：我导入的大文件，需要RAG的
这里感觉比较复杂，需要你给我建议我们一起讨论一下记忆上下文这些怎么规划效果更好
7. 给你的
记得存walkthrough和更新文档😭


